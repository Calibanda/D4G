var json,zipcode,oldsearch={},storedata=[];function init(){fetch("js/departements_cities.json",{method:"GET",mode:"cors"}).then(function(e){return e.json()}).then(function(e){var t=document.getElementById("Departement");for(let n=0;n<e.length;n++){var d=document.createElement("option");d.setAttribute("name",e[n].name),d.text=e[n].name,t.add(d)}json=e})}function buttRGPD(){var e=document.getElementById("rgpd");document.getElementById("cgu").style.display="none","block"===e.style.display?e.style.display="none":e.style.display="block"}function buttCGU(){var e=document.getElementById("cgu");document.getElementById("rgpd").style.display="none","block"===e.style.display?e.style.display="none":e.style.display="block"}function returnCP(){value=document.getElementById("list_citie").value,retourCP=value.match(/[0-9]{5}/),document.getElementById("CodePostal").value=retourCP,console.log(retourCP)}function ChooseCitie(){if(json){for(var e=document.getElementById("Departement").value,t=document.getElementById("list_citie");t.firstChild;)t.removeChild(t.firstChild);for(let n=0;n<json.length;n++)if(json[n].name==e)for(key in json[n].cities){var d=document.createElement("option");d.text=`${key}: ${json[n].cities[key]}`,t.add(d)}console.log(d)}}function generate_data(e){for(var t=document.getElementById("communes");t.firstChild;)t.removeChild(t.firstChild);h1=document.createElement("h1"),t.appendChild(h1);var d=document.createElement("table"),n=document.createElement("tr"),a=document.createElement("th"),o=document.createTextNode("");a.appendChild(o),n.appendChild(a);var c=document.createElement("th");o=document.createTextNode("Score global");c.appendChild(o),n.appendChild(c);var l=document.createElement("th");o=document.createTextNode("Accès aux interfaces numériques");l.appendChild(o),n.appendChild(l);var i=document.createElement("th");o=document.createTextNode("Accès à l'information");i.appendChild(o),n.appendChild(i);var m=document.createElement("th");o=document.createTextNode("Compétences administratives");m.appendChild(o),n.appendChild(m);var p=document.createElement("th");o=document.createTextNode("Compétences numériques / scolaires");p.appendChild(o),n.appendChild(p),d.appendChild(n),e.forEach(e=>{var t=document.createElement("tr"),n=document.createElement("td"),a=document.createTextNode(e.Libcom!=e["Nom Iris"]?e.Libcom+" "+e["Nom Iris"]:e.Libcom);n.appendChild(a),t.appendChild(n);n=document.createElement("td"),a=document.createTextNode(e["SCORE GLOBAL epci 1"]);n.appendChild(a),t.appendChild(n);n=document.createElement("td"),a=document.createTextNode(e["ACCÈS AUX INTERFACES NUMERIQUES epci 1"]);n.appendChild(a),t.appendChild(n);n=document.createElement("td"),a=document.createTextNode(e["ACCES A L'INFORMATION epci 1"]);n.appendChild(a),t.appendChild(n);n=document.createElement("td"),a=document.createTextNode(e["COMPETENCES ADMINISTATIVES epci 1"]);n.appendChild(a),t.appendChild(n);n=document.createElement("td"),a=document.createTextNode(e["COMPÉTENCES NUMÉRIQUES / SCOLAIRES epci 1"]);n.appendChild(a),t.appendChild(n),d.appendChild(t);t=document.createElement("tr"),n=document.createElement("td"),a=document.createTextNode(e.Libdep);n.appendChild(a),t.appendChild(n);n=document.createElement("td"),a=document.createTextNode(e["SCORE GLOBAL departement 1"]);n.appendChild(a),t.appendChild(n);n=document.createElement("td"),a=document.createTextNode(e["ACCÈS AUX INTERFACES NUMERIQUES departement 1"]);n.appendChild(a),t.appendChild(n);n=document.createElement("td"),a=document.createTextNode(e["ACCES A L'INFORMATION departement 1"]);n.appendChild(a),t.appendChild(n);n=document.createElement("td"),a=document.createTextNode(e["COMPETENCES ADMINISTATIVES departement 1"]);n.appendChild(a),t.appendChild(n);n=document.createElement("td"),a=document.createTextNode(e["COMPÉTENCES NUMÉRIQUES / SCOLAIRES departement 1"]);n.appendChild(a),t.appendChild(n),d.appendChild(t);t=document.createElement("tr"),n=document.createElement("td"),a=document.createTextNode(e.Libreg);n.appendChild(a),t.appendChild(n);n=document.createElement("td"),a=document.createTextNode(e["SCORE GLOBAL region * "]);n.appendChild(a),t.appendChild(n);n=document.createElement("td"),a=document.createTextNode(e["ACCÈS AUX INTERFACES NUMERIQUES region 1"]);n.appendChild(a),t.appendChild(n);n=document.createElement("td"),a=document.createTextNode(e["ACCES A L'INFORMATION region 1"]);n.appendChild(a),t.appendChild(n);n=document.createElement("td"),a=document.createTextNode(e["COMPETENCES ADMINISTATIVES region 1"]);n.appendChild(a),t.appendChild(n);n=document.createElement("td"),a=document.createTextNode(e["COMPÉTENCES NUMÉRIQUES / SCOLAIRES region 1"]);n.appendChild(a),t.appendChild(n),d.appendChild(t)}),t.appendChild(d),document.getElementById("donnees").style.boxShadow="0 4px 6px 0 rgba(0, 0, 0, 0.3)",document.getElementById("pdf-button").style.display="block"}function createPdf(){document.getElementById("pdf-button").disabled=!0;var e=new jsPDF;e.setFontSize(22),e.text(20,20,"Résultats de l’indice de fragilité numérique"),e.setFontSize(16),data=oldsearch[Object.keys(oldsearch)[0]];for(let d=0;d<data.length;d++){var t=data[d].Libcom!=data[d]["Nom Iris"]?data[d].Libcom+" "+data[d]["Nom Iris"]:data[d].Libcom;e.text(20,30+d%4*70,"Ville de "+t),e.text(20,40+d%4*70,"Score global : "+data[d]["SCORE GLOBAL epci 1"]),e.text(20,50+d%4*70,"Accès aux interfaces numériques : "+data[d]["ACCÈS AUX INTERFACES NUMERIQUES epci 1"]),e.text(20,60+d%4*70,"Accès à l'information : "+data[d]["ACCES A L'INFORMATION epci 1"]),e.text(20,70+d%4*70,"Compétences administratives : "+data[d]["COMPETENCES ADMINISTATIVES epci 1"]),e.text(20,80+d%4*70,"Compétences numériques / scolaires : "+data[d]["COMPÉTENCES NUMÉRIQUES / SCOLAIRES epci 1"]),d>0&&(d+1)%4==0&&e.addPage()}e.save("IFN.pdf"),document.getElementById("pdf-button").disabled=!1}window.onload=function(){retourCP="",init()};